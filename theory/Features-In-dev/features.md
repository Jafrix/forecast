# Feature Toggles

Feature Toggles в GitLab CI/CD. Это те самые переключатели, которые позволяют активировать или деактивировать функции без повторного развертывания кода.

Польза:
 - Быстрое развертывание незавершенных фич: код в проде, но скрыт от пользователей.
 - A/B тестирование: включаем новую фичу для определенной группы пользователей.
 - Безопасное отключение: если что‑то пошло не так, можем быстро откатиться.

# Реализация Feature Toggles в GitLab CI/CD

В настройках проекта GitLab переходим в Settings > CI/CD > Variables и добавляем переменную:

KEY: FEATURE_NEW_COOL_STUFF
Value: true

Не забудьте установить флажок «Protect variable», чтобы переменная была доступна только защищенным веткам.

Теперь в нашем приложении (предположим, на Python) мы можем использовать эту переменную:
```python
import os

if os.getenv('FEATURE_NEW_COOL_STUFF') == 'true':
    # Включаем новую фичу
    def new_cool_feature():
        print("Новая крутая фича активирована!")
else:
    # Старое поведение
    def new_cool_feature():
        print("Старая добрая функциональность.")
```
Добавим использование переменной в наш CI/CD пайплайн:

*Делаем фичу динамически переключаемой*

Хорошо, переменную задали, но что, если нам нужно менять состояние фичи без редеплоя? Тут на помощь приходит хранение конфигурации вне приложения, например, в Redis или базе данных.
Предположим, есть Redis‑сервер. Мы можем хранить состояния фичей там.


# Feature Toggles — мощный инструмент, но, как и со всем мощным, с ним нужно обращаться осторожно. Не злоупотребляйте фичами: каждая новая фича добавляет сложность в ваш код. Регулярно проводите «генеральную уборку» — удаляйте ненужные переключатели, чтобы не превратить кодовую базу в спагетти‑код. И, конечно же, документируйте свои фичи. Ваши коллеги (и вы сами через пару месяцев) скажут вам спасибо. Или, по крайней мере, не будут на вас сердиться.
